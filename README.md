# æ°´æœç§ç±»æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€å…¨çƒäººå£çš„ä¸æ–­å¢é•¿å’ŒåŸå¸‚åŒ–è¿›ç¨‹çš„åŠ å¿«ï¼Œé£Ÿå“å®‰å…¨å’Œå†œä¸šç”Ÿäº§çš„å¯æŒç»­æ€§é—®é¢˜æ—¥ç›Šå‡¸æ˜¾ã€‚æ°´æœä½œä¸ºäººç±»æ—¥å¸¸é¥®é£Ÿä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ï¼Œå…¶ç§ç±»ç¹å¤šã€è¥å…»ä¸°å¯Œï¼Œå…·æœ‰é‡è¦çš„ç»æµå’Œç¤¾ä¼šä»·å€¼ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„æ°´æœç§ç±»è¯†åˆ«æ–¹æ³•å¾€å¾€ä¾èµ–äºäººå·¥è§‚å¯Ÿå’Œç»éªŒåˆ¤æ–­ï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å—åˆ°ä¸»è§‚å› ç´ çš„å½±å“ã€‚è¿‘å¹´æ¥ï¼Œè®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„è¿…çŒ›å‘å±•ä¸ºæ°´æœç§ç±»çš„è‡ªåŠ¨è¯†åˆ«æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯åŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹ç®—æ³•åœ¨å›¾åƒè¯†åˆ«é¢†åŸŸå±•ç°å‡ºäº†ä¼˜å¼‚çš„æ€§èƒ½ã€‚

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•ä½œä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä»£è¡¨æ€§æ–¹æ³•ï¼Œä»¥å…¶é«˜æ•ˆçš„å®æ—¶æ£€æµ‹èƒ½åŠ›å’Œè¾ƒé«˜çš„å‡†ç¡®ç‡å—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ï¼Œé€‚ç”¨äºå„ç§å¤æ‚åœºæ™¯ä¸‹çš„ç›®æ ‡è¯†åˆ«ä»»åŠ¡ã€‚é’ˆå¯¹æ°´æœç§ç±»çš„æ£€æµ‹ï¼ŒYOLOv8èƒ½å¤Ÿå¿«é€Ÿå¤„ç†å¤§é‡å›¾åƒæ•°æ®ï¼Œå¹¶å‡†ç¡®è¯†åˆ«å‡ºä¸åŒç§ç±»çš„æ°´æœï¼Œä¸ºå†œä¸šç”Ÿäº§ã€å¸‚åœºé”€å”®åŠé£Ÿå“å®‰å…¨ç›‘æµ‹æä¾›äº†å¼ºæœ‰åŠ›çš„æŠ€æœ¯æ”¯æŒã€‚

æœ¬ç ”ç©¶åŸºäºæ”¹è¿›çš„YOLOv8æ¨¡å‹ï¼Œæ„å»ºäº†ä¸€å¥—æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿï¼Œæ—¨åœ¨å®ç°å¯¹å¤šç§æ°´æœçš„å¿«é€Ÿã€å‡†ç¡®è¯†åˆ«ã€‚æˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ•°æ®é›†â€œayushvision_fruitsâ€åŒ…å«1600å¼ å›¾åƒï¼Œæ¶µç›–äº†9ç§ä¸åŒçš„æ°´æœç±»åˆ«ï¼ŒåŒ…æ‹¬å°åº¦éº»ã€è—¤ç“œã€é’æŸ ã€é•¿æ¤’ã€ä½©è¾¾åˆ©ä¹Œå§†ã€çº¢è±Œè±†èŒ„å­ã€ç¯è™«æ¤ç‰©ã€åˆºè‹¹æœå’Œè“–éº»ã€‚è¿™äº›æ°´æœåœ¨ä¸åŒçš„ç”Ÿé•¿ç¯å¢ƒå’Œå¸‚åœºä¸­å…·æœ‰å¹¿æ³›çš„åº”ç”¨ä»·å€¼ï¼Œç„¶è€Œç”±äºå…¶å¤–è§‚ç›¸ä¼¼æ€§å’Œç”Ÿé•¿ç¯å¢ƒçš„å¤šæ ·æ€§ï¼Œä¼ ç»Ÿçš„è¯†åˆ«æ–¹æ³•å¾€å¾€éš¾ä»¥å®ç°é«˜æ•ˆå‡†ç¡®çš„åˆ†ç±»ã€‚å› æ­¤ï¼ŒåŸºäºYOLOv8çš„æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºæ„ä¹‰ï¼Œä¹Ÿå…·æœ‰å¹¿æ³›çš„å®é™…åº”ç”¨å‰æ™¯ã€‚

é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æå’Œæ¨¡å‹çš„ä¼˜åŒ–è°ƒæ•´ï¼Œæœ¬ç ”ç©¶å°†æ¢ç´¢å¦‚ä½•åœ¨ä¿è¯æ£€æµ‹ç²¾åº¦çš„å‰æä¸‹ï¼Œæé«˜æ¨¡å‹çš„å®æ—¶æ€§å’Œé€‚åº”æ€§ã€‚æˆ‘ä»¬å°†é‡‡ç”¨æ•°æ®å¢å¼ºã€è¿ç§»å­¦ä¹ ç­‰æŠ€æœ¯æ‰‹æ®µï¼Œæå‡æ¨¡å‹åœ¨ä¸åŒç¯å¢ƒä¸‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œä»¥åº”å¯¹æ°´æœç§ç±»å¤šæ ·æ€§å’Œå›¾åƒè´¨é‡å·®å¼‚å¸¦æ¥çš„æŒ‘æˆ˜ã€‚æ­¤å¤–ï¼Œç ”ç©¶è¿˜å°†ç»“åˆå®é™…åº”ç”¨åœºæ™¯ï¼Œæ¢è®¨è¯¥æ£€æµ‹ç³»ç»Ÿåœ¨æ™ºèƒ½å†œä¸šã€ç‰©æµç®¡ç†åŠé£Ÿå“å®‰å…¨ç­‰é¢†åŸŸçš„åº”ç”¨æ½œåŠ›ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…ä¸ºæ°´æœè¯†åˆ«æä¾›äº†ä¸€ç§é«˜æ•ˆçš„æŠ€æœ¯æ‰‹æ®µï¼Œä¹Ÿä¸ºæ¨åŠ¨å†œä¸šæ™ºèƒ½åŒ–ã€æå‡é£Ÿå“å®‰å…¨ç®¡ç†æ°´å¹³æä¾›äº†æ–°çš„æ€è·¯å’Œæ–¹æ³•ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥å’Œåº”ç”¨çš„æ·±å…¥ï¼ŒæœŸå¾…è¯¥ç³»ç»Ÿèƒ½å¤Ÿåœ¨æœªæ¥çš„å†œä¸šç”Ÿäº§å’Œå¸‚åœºæµé€šä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼ŒåŠ©åŠ›å®ç°å¯æŒç»­å‘å±•ç›®æ ‡ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1tBxFeME9K/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 8
names: ['Indian_mallow', 'Ivy_gourd', 'Lime', 'Long_pepper', 'Pedaliummurex', 'Red_Pea_Eggplant', 'Ring_worm_plant', 'ThornApple']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œæ•°æ®é›†çš„è´¨é‡å’Œå¤šæ ·æ€§ç›´æ¥å½±å“ç€æ¨¡å‹çš„è®­ç»ƒæ•ˆæœå’Œåº”ç”¨æ€§èƒ½ã€‚ä¸ºäº†æ”¹è¿›YOLOv8çš„æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿï¼Œæˆ‘ä»¬é€‰ç”¨äº†åä¸ºâ€œayushvision_fruitsâ€çš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ä¸“æ³¨äºç‰¹å®šçš„æ¤ç‰©ç§ç±»ï¼Œæ¶µç›–äº†å…«ä¸ªç‹¬ç‰¹çš„ç±»åˆ«ã€‚è¿™äº›ç±»åˆ«åŒ…æ‹¬å°åº¦æœ¨æ§¿ï¼ˆIndian mallowï¼‰ã€è—¤ç“œï¼ˆIvy gourdï¼‰ã€é’æŸ ï¼ˆLimeï¼‰ã€é•¿æ¤’ï¼ˆLong pepperï¼‰ã€Pedaliummurexã€çº¢è±Œè±†èŒ„ï¼ˆRed Pea Eggplantï¼‰ã€ç¯è™«è‰ï¼ˆRing worm plantï¼‰å’Œåˆºè‹¹æœï¼ˆThorn Appleï¼‰ã€‚æ¯ä¸€ä¸ªç±»åˆ«éƒ½ä»£è¡¨äº†ç‰¹å®šçš„æ¤ç‰©ç‰¹å¾å’Œç”Ÿé•¿ç¯å¢ƒï¼Œèƒ½å¤Ÿä¸ºæ¨¡å‹æä¾›ä¸°å¯Œçš„è§†è§‰ä¿¡æ¯ã€‚

â€œayushvision_fruitsâ€æ•°æ®é›†çš„è®¾è®¡æ—¨åœ¨ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹æä¾›é«˜è´¨é‡çš„è®­ç»ƒæ ·æœ¬ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¯†åˆ«å’Œåˆ†ç±»ä¸åŒç§ç±»çš„æ°´æœå’Œæ¤ç‰©ã€‚æ•°æ®é›†ä¸­åŒ…å«çš„å…«ä¸ªç±»åˆ«ä¸ä»…åœ¨å¤–è§‚ä¸Šå„å…·ç‰¹è‰²ï¼Œè€Œä¸”åœ¨ç”Ÿç‰©å­¦ç‰¹æ€§å’Œç”Ÿæ€ç¯å¢ƒä¸Šä¹Ÿå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚è¿™ç§å¤šæ ·æ€§ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´åŠ ç»†è‡´çš„ç‰¹å¾ï¼Œä»è€Œæé«˜å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„è¯†åˆ«å‡†ç¡®ç‡ã€‚ä¾‹å¦‚ï¼Œå°åº¦æœ¨æ§¿ä»¥å…¶ç‹¬ç‰¹çš„èŠ±å½¢å’Œå¶ç‰‡ç»“æ„è€Œé—»åï¼Œè€Œè—¤ç“œåˆ™å› å…¶ç‰¹æ®Šçš„æœå®å½¢æ€è€Œæ˜“äºè¾¨è¯†ã€‚é’æŸ å’Œé•¿æ¤’åˆ™åœ¨é¢œè‰²å’Œå½¢çŠ¶ä¸Šæœ‰æ˜æ˜¾çš„å·®å¼‚ï¼Œè¿™ä¸ºæ¨¡å‹æä¾›äº†ä¸°å¯Œçš„è§†è§‰çº¿ç´¢ã€‚

åœ¨æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç ”ç©¶å›¢é˜Ÿæ³¨é‡æ•°æ®çš„æ ‡æ³¨ç²¾åº¦å’Œæ ·æœ¬çš„å¤šæ ·æ€§ã€‚æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬éƒ½ç»è¿‡ç²¾å¿ƒæŒ‘é€‰å’Œæ ‡æ³¨ï¼Œç¡®ä¿å…¶åœ¨ä¸åŒç”Ÿé•¿é˜¶æ®µã€ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„è¡¨ç°éƒ½èƒ½è¢«å……åˆ†è®°å½•ã€‚è¿™ç§ç»†è‡´çš„æ ‡æ³¨æ–¹å¼ä¸ä»…æå‡äº†æ•°æ®é›†çš„å®ç”¨æ€§ï¼Œä¹Ÿä¸ºåç»­çš„æ¨¡å‹è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ã€‚é€šè¿‡å¯¹ä¸åŒç±»åˆ«çš„æ¤ç‰©è¿›è¡Œå……åˆ†çš„æ ·æœ¬æ”¶é›†ï¼Œæ•°æ®é›†èƒ½å¤Ÿæ¶µç›–å„ç§å¯èƒ½çš„å˜å¼‚æƒ…å†µï¼Œä»è€Œå¢å¼ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†çš„ä½¿ç”¨ä¹Ÿä¸ºç ”ç©¶äººå‘˜æä¾›äº†ä¸€ä¸ªè‰¯å¥½çš„å¹³å°ï¼Œä»¥ä¾¿åœ¨YOLOv8çš„åŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥çš„æ”¹è¿›å’Œä¼˜åŒ–ã€‚YOLOv8ä½œä¸ºä¸€ç§å…ˆè¿›çš„ç›®æ ‡æ£€æµ‹ç®—æ³•ï¼Œèƒ½å¤Ÿåœ¨å®æ—¶åº”ç”¨ä¸­æä¾›é«˜æ•ˆçš„æ£€æµ‹æ€§èƒ½ï¼Œè€Œâ€œayushvision_fruitsâ€æ•°æ®é›†åˆ™ä¸ºå…¶æä¾›äº†ä¸°å¯Œçš„è®­ç»ƒæ•°æ®ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨æ°´æœç§ç±»æ£€æµ‹ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚é€šè¿‡ä¸æ–­åœ°è¿­ä»£å’Œä¼˜åŒ–ï¼Œç ”ç©¶äººå‘˜å¯ä»¥åˆ©ç”¨è¯¥æ•°æ®é›†è¿›è¡Œå®éªŒï¼Œæ¢ç´¢ä¸åŒçš„ç½‘ç»œæ¶æ„å’Œè®­ç»ƒç­–ç•¥ï¼Œä»è€Œæ¨åŠ¨æ°´æœç§ç±»æ£€æµ‹æŠ€æœ¯çš„å‘å±•ã€‚

æ€»ä¹‹ï¼Œâ€œayushvision_fruitsâ€æ•°æ®é›†ä¸ä»…ä¸ºæ”¹è¿›YOLOv8çš„æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿæä¾›äº†ä¸°å¯Œçš„è®­ç»ƒæ•°æ®ï¼Œè¿˜ä¸ºç›¸å…³ç ”ç©¶æä¾›äº†é‡è¦çš„å®éªŒåŸºç¡€ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æå’Œåº”ç”¨ï¼Œç ”ç©¶äººå‘˜èƒ½å¤Ÿä¸æ–­æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œä¸ºå®é™…åº”ç”¨ä¸­çš„æ°´æœè¯†åˆ«å’Œåˆ†ç±»ä»»åŠ¡æä¾›æ›´åŠ å¯é çš„è§£å†³æ–¹æ¡ˆã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥å’Œæ•°æ®é›†çš„ä¸æ–­ä¸°å¯Œï¼Œæœªæ¥çš„æ°´æœç§ç±»æ£€æµ‹ç³»ç»Ÿå°†ä¼šæ›´åŠ æ™ºèƒ½åŒ–å’Œé«˜æ•ˆåŒ–ï¼Œä¸ºå†œä¸šã€é£Ÿå“å®‰å…¨å’Œç”Ÿæ€ä¿æŠ¤ç­‰é¢†åŸŸå¸¦æ¥æ·±è¿œçš„å½±å“ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8æ˜¯ç”±Ultralyticså›¢é˜Ÿåœ¨YOLOv5çš„åŸºç¡€ä¸Šå‘å±•è€Œæ¥çš„æœ€æ–°ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œäº2023å¹´1æœˆæ­£å¼æå‡ºã€‚è¯¥æ¨¡å‹åœ¨å¸æ”¶äº†YOLOç³»åˆ—çš„ä¼˜ç‚¹å’Œç»è¿‡å®è·µéªŒè¯çš„æ”¹è¿›æŠ€æœ¯çš„åŸºç¡€ä¸Šï¼Œè‡´åŠ›äºæå‡ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®æ€§å’Œé€Ÿåº¦ã€‚YOLOv8ä¸ä»…å»¶ç»­äº†YOLOç³»åˆ—çš„é«˜æ•ˆæ€§å’Œå®æ—¶æ€§ï¼Œè¿˜åœ¨ç½‘ç»œç»“æ„å’ŒæŸå¤±å‡½æ•°ç­‰å¤šä¸ªæ–¹é¢è¿›è¡Œäº†åˆ›æ–°å’Œä¼˜åŒ–ã€‚

YOLOv8çš„ç½‘ç»œç»“æ„ä¸»è¦ç”±è¾“å…¥å±‚ã€ä¸»å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œç»„æˆã€‚è¾“å…¥å±‚è´Ÿè´£å°†è¾“å…¥å›¾åƒè°ƒæ•´ä¸ºæ¨¡å‹æ‰€éœ€çš„å›ºå®šå°ºå¯¸ï¼Œé€šå¸¸ä¸º640x640åƒç´ ã€‚æ¥ä¸‹æ¥ï¼Œä¸»å¹²ç½‘ç»œé€šè¿‡å·ç§¯æ“ä½œå¯¹å›¾åƒè¿›è¡Œç‰¹å¾æå–ã€‚YOLOv8åœ¨ä¸»å¹²ç½‘ç»œä¸­é‡‡ç”¨äº†C2fæ¨¡å—ï¼Œè¿™ä¸€æ¨¡å—æ˜¯å¯¹YOLOv5ä¸­C3æ¨¡å—çš„æ”¹è¿›ï¼Œå€Ÿé‰´äº†YOLOv7ä¸­çš„ELANç»“æ„ï¼Œå¢åŠ äº†æ›´å¤šçš„è·³å±‚è¿æ¥ã€‚è¿™ç§è®¾è®¡ä¸ä»…æé«˜äº†æ¨¡å‹çš„æ¢¯åº¦æµåŠ¨æ€§ï¼Œè¿˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šå®ç°äº†æ¨¡å‹çš„è½»é‡åŒ–ï¼Œç¡®ä¿äº†åœ¨ä¿æŒé«˜æ£€æµ‹ç²¾åº¦çš„åŒæ—¶ï¼Œè®¡ç®—èµ„æºçš„æ¶ˆè€—å¾—ä»¥é™ä½ã€‚

åœ¨ç‰¹å¾æå–çš„è¿‡ç¨‹ä¸­ï¼ŒYOLOv8ä¾ç„¶ä¿ç•™äº†SPPFï¼ˆSpatial Pyramid Pooling Fastï¼‰æ¨¡å—ï¼Œä»¥å¢å¼ºç½‘ç»œå¯¹å¤šå°ºåº¦ç‰¹å¾çš„å¤„ç†èƒ½åŠ›ã€‚SPPFæ¨¡å—é€šè¿‡ä¸‰ä¸ªæœ€å¤§æ± åŒ–å±‚çš„ç»„åˆï¼Œæœ‰æ•ˆåœ°æå‡äº†ç½‘ç»œçš„ç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰åˆ°ä¸åŒå°ºåº¦çš„ç›®æ ‡ä¿¡æ¯ã€‚

é¢ˆéƒ¨ç½‘ç»œçš„è®¾è®¡ä¸Šï¼ŒYOLOv8é‡‡ç”¨äº†PAN-FPNï¼ˆPath Aggregation Network - Feature Pyramid Networkï¼‰ç»“æ„ï¼Œè¿™ä¸€ç»“æ„æ—¨åœ¨èåˆä¸åŒå±‚æ¬¡çš„ç‰¹å¾å›¾ä¿¡æ¯ã€‚ä¸YOLOv5ç›¸æ¯”ï¼ŒYOLOv8åœ¨ä¸Šé‡‡æ ·é˜¶æ®µçš„å·ç§¯è¿æ¥å±‚è¿›è¡Œäº†ç®€åŒ–ï¼Œè¿›ä¸€æ­¥æå‡äº†ç‰¹å¾èåˆçš„æ•ˆç‡ã€‚é€šè¿‡è¿™ç§ç»“æ„ï¼ŒYOLOv8èƒ½å¤Ÿæ›´å¥½åœ°æ•´åˆæ¥è‡ªæµ…å±‚å’Œæ·±å±‚çš„ç‰¹å¾ä¿¡æ¯ï¼Œä»è€Œæé«˜ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚

åœ¨å¤´éƒ¨ç½‘ç»œä¸­ï¼ŒYOLOv8å¼•å…¥äº†è§£è€¦å¤´çš„è®¾è®¡ç†å¿µã€‚ä¸ä¼ ç»Ÿçš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ä¸åŒï¼ŒYOLOv8çš„å¤´éƒ¨ç½‘ç»œé‡‡ç”¨äº†ä¸¤ä¸ªå¹¶è¡Œçš„åˆ†æ”¯ï¼Œåˆ†åˆ«è´Ÿè´£ç±»åˆ«å’Œä½ç½®ç‰¹å¾çš„æå–ã€‚è¿™ç§è®¾è®¡ä½¿å¾—æ¨¡å‹åœ¨è¿›è¡Œåˆ†ç±»å’Œå®šä½æ—¶ï¼Œèƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºå„è‡ªçš„ä»»åŠ¡ï¼Œä»è€Œæé«˜äº†æ”¶æ•›é€Ÿåº¦å’Œé¢„æµ‹ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒYOLOv8æ‘’å¼ƒäº†ä¼ ç»Ÿçš„é”šæ¡†ç»“æ„ï¼Œè½¬è€Œé‡‡ç”¨æ— é”šæ¡†çš„é¢„æµ‹æ–¹å¼ï¼Œç›´æ¥é¢„æµ‹ç›®æ ‡çš„ä¸­å¿ƒä½ç½®ã€‚è¿™ä¸€åˆ›æ–°ä½¿å¾—æ¨¡å‹åœ¨å¤„ç†ä¸åŒå°ºå¯¸å’Œå½¢çŠ¶çš„ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿæ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚

ä¸ºäº†è¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ€§èƒ½ï¼ŒYOLOv8åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šä¹Ÿè¿›è¡Œäº†ä¼˜åŒ–ã€‚æ¨¡å‹é‡‡ç”¨äº†VFLLossä½œä¸ºåˆ†ç±»æŸå¤±ï¼Œå¹¶ç»“åˆDFLLosså’ŒCIoULossæ¥è®¡ç®—å›å½’æŸå¤±ã€‚é€šè¿‡è¿™ç§ç»„åˆï¼ŒYOLOv8èƒ½å¤Ÿåœ¨åˆ†ç±»å’Œå®šä½ä»»åŠ¡ä¸­å®ç°æ›´å¥½çš„æ€§èƒ½å¹³è¡¡ã€‚æ­¤å¤–ï¼ŒYOLOv8è¿˜å¼•å…¥äº†ä»»åŠ¡å¯¹é½å­¦ä¹ ï¼ˆTask Alignment Learningï¼‰æœºåˆ¶ï¼Œä»¥ä¼˜åŒ–æ­£è´Ÿæ ·æœ¬çš„åŒ¹é…ç­–ç•¥ã€‚è¿™ä¸€æœºåˆ¶é€šè¿‡å¼•å…¥åˆ†ç±»åˆ†æ•°å’ŒIOUçš„é«˜æ¬¡å¹‚ä¹˜ç§¯ï¼Œä½œä¸ºè¡¡é‡ä»»åŠ¡å¯¹é½ç¨‹åº¦çš„æŒ‡æ ‡ï¼Œç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤ŸåŒæ—¶å…¼é¡¾åˆ†ç±»å’Œå®šä½çš„ç²¾åº¦ã€‚

åœ¨æ•°æ®å¢å¼ºæ–¹é¢ï¼ŒYOLOv8å¯¹Mosaicæ•°æ®å¢å¼ºçš„ä½¿ç”¨è¿›è¡Œäº†åæ€ã€‚å°½ç®¡Mosaicå¢å¼ºåœ¨æå‡æ¨¡å‹é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›æ–¹é¢è¡¨ç°è‰¯å¥½ï¼Œä½†å…¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯èƒ½ä¼šç ´åæ•°æ®çš„çœŸå®åˆ†å¸ƒã€‚ä¸ºæ­¤ï¼ŒYOLOv8åœ¨è®­ç»ƒçš„æœ€å10ä¸ªepochä¸­åœæ­¢ä½¿ç”¨Mosaicå¢å¼ºï¼Œä»¥é¿å…æ¨¡å‹å­¦ä¹ åˆ°ä¸è‰¯ä¿¡æ¯ã€‚

YOLOv8åœ¨å®é™…åº”ç”¨ä¸­çš„è¡¨ç°ä¹Ÿå¾—åˆ°äº†éªŒè¯ã€‚æ ¹æ®å®˜æ–¹åœ¨COCOæ•°æ®é›†ä¸Šçš„æµ‹è¯•ç»“æœï¼ŒYOLOv8åœ¨åŒå°ºå¯¸æ¨¡å‹ä¸­ï¼Œå‚æ•°é‡æ²¡æœ‰æ˜¾è‘—å¢åŠ çš„æƒ…å†µä¸‹ï¼Œå–å¾—äº†æ¯”å…¶ä»–æ¨¡å‹æ›´é«˜çš„æ£€æµ‹ç²¾åº¦ã€‚åŒæ—¶ï¼ŒYOLOv8åœ¨æ¨ç†é€Ÿåº¦ä¸Šä¹Ÿè¡¨ç°å‡ºè‰²ï¼Œèƒ½å¤Ÿæ»¡è¶³å®æ—¶ç›®æ ‡æ£€æµ‹çš„éœ€æ±‚ã€‚è¿™äº›ä¼˜è¶Šçš„æ€§èƒ½ä½¿å¾—YOLOv8åœ¨åƒåœ¾ç›®æ ‡æ£€æµ‹ç­‰éœ€è¦å®æ—¶æ€§å’Œå‡†ç¡®æ€§å…¼é¡¾çš„ä»»åŠ¡ä¸­ï¼Œå±•ç°å‡ºæå¤§çš„åº”ç”¨æ½œåŠ›ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8ä½œä¸ºYOLOç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œé€šè¿‡åœ¨ç½‘ç»œç»“æ„ã€æŸå¤±å‡½æ•°ã€æ•°æ®å¢å¼ºå’Œä»»åŠ¡å¯¹é½ç­‰å¤šä¸ªæ–¹é¢çš„åˆ›æ–°å’Œä¼˜åŒ–ï¼Œæ˜¾è‘—æå‡äº†ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®æ€§å’Œé€Ÿåº¦ã€‚å…¶è½»é‡åŒ–è®¾è®¡å’Œé«˜æ•ˆçš„ç‰¹å¾æå–èƒ½åŠ›ï¼Œä½¿å¾—YOLOv8åœ¨å„ç§å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å®æ—¶å¤„ç†çš„ä»»åŠ¡ä¸­ï¼Œå±•ç°å‡ºå¼ºå¤§çš„ç«äº‰åŠ›ã€‚éšç€YOLOv8çš„ä¸æ–­å‘å±•å’Œåº”ç”¨ï¼Œå…¶åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ç ”ç©¶å’Œåº”ç”¨ä»·å€¼å°†ä¼šè¿›ä¸€æ­¥æå‡ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\utils\callbacks\base.py

ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æœï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license
"""åŸºç¡€å›è°ƒå‡½æ•°å®šä¹‰ã€‚"""

from collections import defaultdict
from copy import deepcopy

# é»˜è®¤å›è°ƒå‡½æ•°å­—å…¸ï¼ŒåŒ…å«è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­çš„å›è°ƒå‡½æ•°
default_callbacks = {
    # è®­ç»ƒè¿‡ç¨‹ä¸­çš„å›è°ƒ
    "on_pretrain_routine_start": [on_pretrain_routine_start],
    "on_train_start": [on_train_start],
    "on_train_epoch_start": [on_train_epoch_start],
    "on_train_batch_start": [on_train_batch_start],
    "optimizer_step": [optimizer_step],
    "on_before_zero_grad": [on_before_zero_grad],
    "on_train_batch_end": [on_train_batch_end],
    "on_train_epoch_end": [on_train_epoch_end],
    "on_train_end": [on_train_end],
    # éªŒè¯è¿‡ç¨‹ä¸­çš„å›è°ƒ
    "on_val_start": [on_val_start],
    "on_val_batch_start": [on_val_batch_start],
    "on_val_batch_end": [on_val_batch_end],
    "on_val_end": [on_val_end],
    # é¢„æµ‹è¿‡ç¨‹ä¸­çš„å›è°ƒ
    "on_predict_start": [on_predict_start],
    "on_predict_batch_start": [on_predict_batch_start],
    "on_predict_batch_end": [on_predict_batch_end],
    "on_predict_end": [on_predict_end],
    # å¯¼å‡ºè¿‡ç¨‹ä¸­çš„å›è°ƒ
    "on_export_start": [on_export_start],
    "on_export_end": [on_export_end],
}

def get_default_callbacks():
    """
    è¿”å›ä¸€ä¸ªåŒ…å«é»˜è®¤å›è°ƒå‡½æ•°çš„å­—å…¸å‰¯æœ¬ï¼Œå­—å…¸çš„é»˜è®¤å€¼ä¸ºåˆ—è¡¨ã€‚

    è¿”å›:
        (defaultdict): ä¸€ä¸ªdefaultdictï¼ŒåŒ…å«default_callbacksä¸­çš„é”®ï¼Œé»˜è®¤å€¼ä¸ºç©ºåˆ—è¡¨ã€‚
    """
    return defaultdict(list, deepcopy(default_callbacks))

def add_integration_callbacks(instance):
    """
    å°†æ¥è‡ªä¸åŒæ¥æºçš„é›†æˆå›è°ƒæ·»åŠ åˆ°å®ä¾‹çš„å›è°ƒå­—å…¸ä¸­ã€‚

    å‚æ•°:
        instance (Trainer, Predictor, Validator, Exporter): ä¸€ä¸ªå¯¹è±¡ï¼Œå…·æœ‰ä¸€ä¸ª'callbacks'å±æ€§ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªå›è°ƒåˆ—è¡¨çš„å­—å…¸ã€‚
    """
    # åŠ è½½HUBå›è°ƒ
    from .hub import callbacks as hub_cb

    callbacks_list = [hub_cb]

    # å¦‚æœå®ä¾‹æ˜¯Trainerç±»ï¼Œåˆ™åŠ è½½è®­ç»ƒç›¸å…³çš„å›è°ƒ
    if "Trainer" in instance.__class__.__name__:
        from .clearml import callbacks as clear_cb
        from .comet import callbacks as comet_cb
        from .dvc import callbacks as dvc_cb
        from .mlflow import callbacks as mlflow_cb
        from .neptune import callbacks as neptune_cb
        from .raytune import callbacks as tune_cb
        from .tensorboard import callbacks as tb_cb
        from .wb import callbacks as wb_cb

        # å°†æ‰€æœ‰å›è°ƒæ·»åŠ åˆ°å›è°ƒåˆ—è¡¨ä¸­
        callbacks_list.extend([clear_cb, comet_cb, dvc_cb, mlflow_cb, neptune_cb, tune_cb, tb_cb, wb_cb])

    # å°†å›è°ƒæ·»åŠ åˆ°å®ä¾‹çš„å›è°ƒå­—å…¸ä¸­
    for callbacks in callbacks_list:
        for k, v in callbacks.items():
            if v not in instance.callbacks[k]:
                instance.callbacks[k].append(v)
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æï¼š
1. **default_callbacks**: è¿™æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå®šä¹‰äº†åœ¨ä¸åŒé˜¶æ®µï¼ˆè®­ç»ƒã€éªŒè¯ã€é¢„æµ‹ã€å¯¼å‡ºï¼‰ä¸­éœ€è¦è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚æ¯ä¸ªé˜¶æ®µéƒ½æœ‰ç‰¹å®šçš„å›è°ƒå‡½æ•°ï¼Œå¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ‰§è¡Œç‰¹å®šçš„æ“ä½œï¼Œæ¯”å¦‚åœ¨æ¯ä¸ªæ‰¹æ¬¡å¼€å§‹æˆ–ç»“æŸæ—¶è®°å½•æ—¥å¿—ã€æ›´æ–°æ¨¡å‹ç­‰ã€‚

2. **get_default_callbacks**: è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªé»˜è®¤å›è°ƒå­—å…¸çš„å‰¯æœ¬ï¼Œä½¿ç”¨`defaultdict`ç¡®ä¿æ¯ä¸ªé”®éƒ½æœ‰ä¸€ä¸ªç©ºåˆ—è¡¨ä½œä¸ºé»˜è®¤å€¼ã€‚è¿™å¯¹äºåŠ¨æ€æ·»åŠ å›è°ƒå‡½æ•°éå¸¸æœ‰ç”¨ã€‚

3. **add_integration_callbacks**: è¿™ä¸ªå‡½æ•°ç”¨äºå°†æ¥è‡ªä¸åŒåº“æˆ–æ¨¡å—çš„å›è°ƒå‡½æ•°æ•´åˆåˆ°ç»™å®šå®ä¾‹çš„å›è°ƒå­—å…¸ä¸­ã€‚å®ƒæ ¹æ®å®ä¾‹çš„ç±»å‹ï¼ˆå¦‚Trainerï¼‰æ¥åŠ è½½ç‰¹å®šçš„å›è°ƒï¼Œç¡®ä¿å®ä¾‹èƒ½å¤Ÿä½¿ç”¨æ‰€æœ‰ç›¸å…³çš„å›è°ƒåŠŸèƒ½ã€‚

### æ€»ç»“ï¼š
è¿™äº›å›è°ƒå‡½æ•°ä¸ºæ¨¡å‹è®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹æä¾›äº†çµæ´»çš„æ‰©å±•ç‚¹ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨è®­ç»ƒçš„ä¸åŒé˜¶æ®µæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œä»¥ä¾¿äºç›‘æ§ã€è®°å½•å’Œä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ä¸­çš„ä¸€ä¸ªåŸºç¡€å›è°ƒæ¨¡å—ï¼Œä¸»è¦ç”¨äºå®šä¹‰å’Œç®¡ç†è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­çš„å„ç§å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°æ˜¯åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œé€šå¸¸ç”¨äºåœ¨è®­ç»ƒæˆ–è¯„ä¼°è¿‡ç¨‹ä¸­æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰æ“ä½œï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€ä¿å­˜æ¨¡å‹ã€è°ƒæ•´å­¦ä¹ ç‡ç­‰ã€‚

æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†`defaultdict`å’Œ`deepcopy`ï¼Œè¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ç”¨äºåˆ›å»ºä¸€ä¸ªå…·æœ‰é»˜è®¤å€¼çš„å­—å…¸å’Œæ·±æ‹·è´å¯¹è±¡ã€‚æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€ç³»åˆ—å›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¢«åˆ†ä¸ºå››ä¸ªä¸»è¦éƒ¨åˆ†ï¼šè®­ç»ƒå›è°ƒã€éªŒè¯å›è°ƒã€é¢„æµ‹å›è°ƒå’Œå¯¼å‡ºå›è°ƒã€‚

åœ¨è®­ç»ƒå›è°ƒéƒ¨åˆ†ï¼Œå®šä¹‰äº†å¤šä¸ªå‡½æ•°ï¼Œä¾‹å¦‚`on_train_start`ã€`on_train_epoch_start`ã€`on_train_batch_start`ç­‰ï¼Œè¿™äº›å‡½æ•°åœ¨è®­ç»ƒçš„ä¸åŒé˜¶æ®µè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œ`on_train_start`åœ¨è®­ç»ƒå¼€å§‹æ—¶è¢«è°ƒç”¨ï¼Œè€Œ`on_train_epoch_end`åˆ™åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶è¢«è°ƒç”¨ã€‚è¿™äº›å‡½æ•°ç›®å‰éƒ½æ˜¯ç©ºçš„ï¼Œæ„å‘³ç€å®ƒä»¬å¯ä»¥è¢«ç”¨æˆ·è‡ªå®šä¹‰å®ç°ï¼Œä»¥ä¾¿åœ¨ç›¸åº”çš„äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚

éªŒè¯å›è°ƒéƒ¨åˆ†ç±»ä¼¼ï¼Œå®šä¹‰äº†`on_val_start`ã€`on_val_batch_start`ç­‰å‡½æ•°ï¼Œç”¨äºåœ¨éªŒè¯è¿‡ç¨‹çš„ä¸åŒé˜¶æ®µæ‰§è¡Œæ“ä½œã€‚

é¢„æµ‹å›è°ƒéƒ¨åˆ†åˆ™åŒ…å«äº†ä¸æ¨¡å‹é¢„æµ‹ç›¸å…³çš„å›è°ƒå‡½æ•°ï¼Œä¾‹å¦‚`on_predict_start`å’Œ`on_predict_end`ï¼Œè¿™äº›å‡½æ•°åœ¨é¢„æµ‹è¿‡ç¨‹çš„å¼€å§‹å’Œç»“æŸæ—¶è¢«è°ƒç”¨ã€‚

å¯¼å‡ºå›è°ƒéƒ¨åˆ†å®šä¹‰äº†`on_export_start`å’Œ`on_export_end`ï¼Œç”¨äºåœ¨æ¨¡å‹å¯¼å‡ºæ—¶æ‰§è¡Œæ“ä½œã€‚

åœ¨æ–‡ä»¶çš„æœ€åï¼Œå®šä¹‰äº†ä¸€ä¸ª`default_callbacks`å­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„å›è°ƒå‡½æ•°ï¼Œå¹¶å°†å®ƒä»¬åˆ†ç»„ï¼Œä»¥ä¾¿åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚è¿™ä¸ªå­—å…¸å¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿè®¿é—®å’Œä½¿ç”¨è¿™äº›å›è°ƒå‡½æ•°ã€‚

`get_default_callbacks`å‡½æ•°è¿”å›ä¸€ä¸ªæ·±æ‹·è´çš„`default_callbacks`å­—å…¸ï¼Œç¡®ä¿æ¯æ¬¡è°ƒç”¨æ—¶éƒ½å¾—åˆ°ä¸€ä¸ªæ–°çš„å­—å…¸å®ä¾‹ï¼Œè€Œä¸ä¼šå½±å“åŸå§‹çš„å›è°ƒè®¾ç½®ã€‚

`add_integration_callbacks`å‡½æ•°ç”¨äºå°†æ¥è‡ªä¸åŒæ¥æºçš„é›†æˆå›è°ƒæ·»åŠ åˆ°ç»™å®šå®ä¾‹çš„å›è°ƒå­—å…¸ä¸­ã€‚å®ƒä¼šæ ¹æ®å®ä¾‹çš„ç±»å‹ï¼ˆå¦‚Trainerã€Predictorç­‰ï¼‰åŠ è½½ä¸åŒçš„å›è°ƒæ¨¡å—ï¼Œå¹¶å°†å®ƒä»¬åˆå¹¶åˆ°å®ä¾‹çš„å›è°ƒåˆ—è¡¨ä¸­ã€‚è¿™ä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æ‰©å±•å’Œé›†æˆå…¶ä»–åŠŸèƒ½æˆ–åº“çš„å›è°ƒï¼Œå¢å¼ºè®­ç»ƒå’Œè¯„ä¼°çš„çµæ´»æ€§ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸ºUltralytics YOLOæä¾›äº†ä¸€ä¸ªçµæ´»çš„å›è°ƒæœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œä»è€Œæé«˜æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°çš„æ•ˆç‡å’Œå¯æ§æ€§ã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤å¹¶ç­‰å¾…å…¶å®Œæˆ
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸º0åˆ™è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥æ›¿æ¢ä¸ºå®é™…çš„è„šæœ¬è·¯å¾„

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åŠæ³¨é‡Šè¯´æ˜ï¼š

1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `import sys`: å¯¼å…¥ç³»ç»Ÿç›¸å…³çš„æ¨¡å—ï¼Œç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `import subprocess`: å¯¼å…¥å­è¿›ç¨‹æ¨¡å—ï¼Œç”¨äºåœ¨ Python ä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **å®šä¹‰ `run_script` å‡½æ•°**ï¼š
   - è¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªè„šæœ¬è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡Œè¯¥è„šæœ¬ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œå¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿è¯¥éƒ¨åˆ†ä»£ç ä»…åœ¨ç›´æ¥è¿è¡Œè„šæœ¬æ—¶æ‰§è¡Œã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆè¿™é‡Œæ˜¯ `"web.py"`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ Streamlit æ¡†æ¶æ¥å¯åŠ¨ä¸€ä¸ª Web åº”ç”¨ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„è·¯å¾„å¤„ç†æ¨¡å— `abs_path`ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ Python ç¯å¢ƒã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè°ƒç”¨ Streamlit æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚å‘½ä»¤çš„æ ¼å¼æ˜¯ `python -m streamlit run script_path`ï¼Œå…¶ä¸­ `script_path` æ˜¯è¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚

ç„¶åï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œåè¿”å›çš„çŠ¶æ€ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œç¨‹åºä¼šæ‰“å°å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¿™ä¸ªæ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™é‡ŒæŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥å¯åŠ¨è¿™ä¸ªè„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½æ˜¯ç®€åŒ–äº†é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ Streamlit åº”ç”¨çš„è¿‡ç¨‹ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ª Python æ–‡ä»¶æ¥å¯åŠ¨ Web åº”ç”¨ã€‚

#### 11.3 code\ultralytics\models\rtdetr\predict.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
from ultralytics.data.augment import LetterBox
from ultralytics.engine.predictor import BasePredictor
from ultralytics.engine.results import Results
from ultralytics.utils import ops

class RTDETRPredictor(BasePredictor):
    """
    RT-DETRï¼ˆå®æ—¶æ£€æµ‹å˜æ¢å™¨ï¼‰é¢„æµ‹å™¨ï¼Œæ‰©å±•è‡ªBasePredictorç±»ï¼Œç”¨äºä½¿ç”¨ç™¾åº¦çš„RT-DETRæ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚

    è¯¥ç±»åˆ©ç”¨è§†è§‰å˜æ¢å™¨çš„å¼ºå¤§åŠŸèƒ½ï¼Œæä¾›å®æ—¶ç‰©ä½“æ£€æµ‹ï¼ŒåŒæ—¶ä¿æŒé«˜ç²¾åº¦ã€‚å®ƒæ”¯æŒé«˜æ•ˆçš„æ··åˆç¼–ç å’ŒIoUæ„ŸçŸ¥æŸ¥è¯¢é€‰æ‹©ç­‰å…³é”®ç‰¹æ€§ã€‚
    """

    def postprocess(self, preds, img, orig_imgs):
        """
        å¯¹æ¨¡å‹çš„åŸå§‹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œä»¥ç”Ÿæˆè¾¹ç•Œæ¡†å’Œç½®ä¿¡åº¦åˆ†æ•°ã€‚

        è¯¥æ–¹æ³•æ ¹æ®ç½®ä¿¡åº¦å’Œç±»è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœåœ¨`self.args`ä¸­æŒ‡å®šäº†ç±»ã€‚

        å‚æ•°:
            preds (torch.Tensor): æ¨¡å‹çš„åŸå§‹é¢„æµ‹ç»“æœã€‚
            img (torch.Tensor): å¤„ç†åçš„è¾“å…¥å›¾åƒã€‚
            orig_imgs (listæˆ–torch.Tensor): åŸå§‹æœªå¤„ç†çš„å›¾åƒã€‚

        è¿”å›:
            (list[Results]): åŒ…å«åå¤„ç†è¾¹ç•Œæ¡†ã€ç½®ä¿¡åº¦åˆ†æ•°å’Œç±»æ ‡ç­¾çš„Resultså¯¹è±¡åˆ—è¡¨ã€‚
        """
        # è·å–é¢„æµ‹ç»“æœçš„ç»´åº¦
        nd = preds[0].shape[-1]
        # å°†é¢„æµ‹ç»“æœåˆ†å‰²ä¸ºè¾¹ç•Œæ¡†å’Œåˆ†æ•°
        bboxes, scores = preds[0].split((4, nd - 4), dim=-1)

        # å¦‚æœè¾“å…¥å›¾åƒä¸æ˜¯åˆ—è¡¨ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºnumpyæ•°ç»„
        if not isinstance(orig_imgs, list):
            orig_imgs = ops.convert_torch2numpy_batch(orig_imgs)

        results = []
        for i, bbox in enumerate(bboxes):  # éå†æ¯ä¸ªè¾¹ç•Œæ¡†
            # å°†è¾¹ç•Œæ¡†ä»xywhæ ¼å¼è½¬æ¢ä¸ºxyxyæ ¼å¼
            bbox = ops.xywh2xyxy(bbox)
            # è·å–æ¯ä¸ªè¾¹ç•Œæ¡†çš„æœ€å¤§åˆ†æ•°å’Œå¯¹åº”çš„ç±»
            score, cls = scores[i].max(-1, keepdim=True)
            # æ ¹æ®ç½®ä¿¡åº¦è¿‡æ»¤è¾¹ç•Œæ¡†
            idx = score.squeeze(-1) > self.args.conf
            # å¦‚æœæŒ‡å®šäº†ç±»ï¼Œåˆ™è¿›ä¸€æ­¥è¿‡æ»¤
            if self.args.classes is not None:
                idx = (cls == torch.tensor(self.args.classes, device=cls.device)).any(1) & idx
            # è¿‡æ»¤åçš„é¢„æµ‹ç»“æœ
            pred = torch.cat([bbox, score, cls], dim=-1)[idx]
            orig_img = orig_imgs[i]
            oh, ow = orig_img.shape[:2]  # è·å–åŸå§‹å›¾åƒçš„é«˜åº¦å’Œå®½åº¦
            # å°†è¾¹ç•Œæ¡†çš„åæ ‡ç¼©æ”¾åˆ°åŸå§‹å›¾åƒçš„å°ºå¯¸
            pred[..., [0, 2]] *= ow
            pred[..., [1, 3]] *= oh
            img_path = self.batch[0][i]  # è·å–å›¾åƒè·¯å¾„
            # å°†ç»“æœæ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­
            results.append(Results(orig_img, path=img_path, names=self.model.names, boxes=pred))
        return results

    def pre_transform(self, im):
        """
        åœ¨å°†è¾“å…¥å›¾åƒè¾“å…¥æ¨¡å‹è¿›è¡Œæ¨ç†ä¹‹å‰ï¼Œå¯¹å…¶è¿›è¡Œé¢„å¤„ç†ã€‚è¾“å…¥å›¾åƒè¢«è°ƒæ•´ä¸ºæ–¹å½¢çš„çºµæ¨ªæ¯”å¹¶å¡«å……ã€‚

        å‚æ•°:
            im (list[np.ndarray] | torch.Tensor): è¾“å…¥å›¾åƒï¼Œå½¢çŠ¶ä¸º(N,3,h,w)çš„å¼ é‡ï¼Œæˆ–[(h,w,3) x N]çš„åˆ—è¡¨ã€‚

        è¿”å›:
            (list): é¢„å¤„ç†åçš„å›¾åƒåˆ—è¡¨ï¼Œå‡†å¤‡è¿›è¡Œæ¨¡å‹æ¨ç†ã€‚
        """
        # åˆ›å»ºLetterBoxå¯¹è±¡ä»¥è¿›è¡Œå›¾åƒè°ƒæ•´
        letterbox = LetterBox(self.imgsz, auto=False, scaleFill=True)
        # å¯¹æ¯ä¸ªå›¾åƒè¿›è¡Œè°ƒæ•´å¹¶è¿”å›
        return [letterbox(image=x) for x in im]
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **RTDETRPredictorç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºå®æ—¶ç‰©ä½“æ£€æµ‹çš„é¢„æµ‹å™¨ï¼Œç»§æ‰¿è‡ª`BasePredictor`ï¼Œä¸»è¦ç”¨äºå¤„ç†æ¨¡å‹çš„è¾“å…¥å’Œè¾“å‡ºã€‚
2. **postprocessæ–¹æ³•**ï¼šè¯¥æ–¹æ³•å¯¹æ¨¡å‹çš„åŸå§‹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œç”Ÿæˆè¾¹ç•Œæ¡†å’Œç½®ä¿¡åº¦åˆ†æ•°ï¼Œå¹¶æ ¹æ®ç½®ä¿¡åº¦å’Œç±»è¿›è¡Œè¿‡æ»¤ã€‚
3. **pre_transformæ–¹æ³•**ï¼šè¯¥æ–¹æ³•å¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œç¡®ä¿å…¶ä¸ºæ–¹å½¢å¹¶å¡«å……ï¼Œä»¥é€‚åº”æ¨¡å‹çš„è¾“å…¥è¦æ±‚ã€‚

è¯¥ç¨‹åºæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ä¸­çš„ä¸€ä¸ªé¢„æµ‹æ¨¡å—ï¼Œä¸“é—¨ç”¨äºå®ç°RT-DETRï¼ˆå®æ—¶æ£€æµ‹å˜æ¢å™¨ï¼‰æ¨¡å‹çš„é¢„æµ‹åŠŸèƒ½ã€‚è¯¥æ¨¡å—ç»§æ‰¿è‡ª`BasePredictor`ç±»ï¼Œåˆ©ç”¨è§†è§‰å˜æ¢å™¨çš„ä¼˜åŠ¿ï¼Œæä¾›é«˜æ•ˆçš„å®æ—¶ç›®æ ‡æ£€æµ‹ï¼ŒåŒæ—¶ä¿æŒè¾ƒé«˜çš„å‡†ç¡®æ€§ã€‚å®ƒæ”¯æŒé«˜æ•ˆçš„æ··åˆç¼–ç å’ŒIoUï¼ˆäº¤å¹¶æ¯”ï¼‰æ„ŸçŸ¥æŸ¥è¯¢é€‰æ‹©ç­‰å…³é”®ç‰¹æ€§ã€‚

åœ¨ä»£ç ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬PyTorchå’Œä¸€äº›Ultralyticsæä¾›çš„å·¥å…·å’Œç±»ã€‚`RTDETRPredictor`ç±»åŒ…å«äº†ä¸¤ä¸ªä¸»è¦çš„æ–¹æ³•ï¼š`postprocess`å’Œ`pre_transform`ã€‚

`postprocess`æ–¹æ³•è´Ÿè´£å¯¹æ¨¡å‹çš„åŸå§‹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œä»¥ç”Ÿæˆè¾¹ç•Œæ¡†å’Œç½®ä¿¡åº¦åˆ†æ•°ã€‚è¯¥æ–¹æ³•é¦–å…ˆä»æ¨¡å‹çš„é¢„æµ‹ç»“æœä¸­åˆ†ç¦»å‡ºè¾¹ç•Œæ¡†å’Œåˆ†æ•°ï¼Œç„¶åæ ¹æ®ç½®ä¿¡åº¦å’Œç±»åˆ«è¿›è¡Œè¿‡æ»¤ã€‚å®ƒä¼šå°†è¿‡æ»¤åçš„ç»“æœè½¬æ¢ä¸ºé€‚åˆè¾“å‡ºçš„æ ¼å¼ï¼ŒåŒ…æ‹¬åŸå§‹å›¾åƒçš„å°ºå¯¸è°ƒæ•´ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªåŒ…å«é¢„æµ‹ç»“æœçš„`Results`å¯¹è±¡åˆ—è¡¨ã€‚

`pre_transform`æ–¹æ³•åˆ™ç”¨äºåœ¨å°†è¾“å…¥å›¾åƒé€å…¥æ¨¡å‹è¿›è¡Œæ¨ç†ä¹‹å‰è¿›è¡Œé¢„å¤„ç†ã€‚å®ƒä¼šå°†è¾“å…¥å›¾åƒè¿›è¡Œä¿¡ç®±å¡«å……ï¼ˆletterboxingï¼‰ï¼Œç¡®ä¿å›¾åƒä¸ºæ­£æ–¹å½¢å¹¶é€‚åº”æ¨¡å‹çš„è¾“å…¥è¦æ±‚ã€‚è¯¥æ–¹æ³•æ¥å—çš„è¾“å…¥å¯ä»¥æ˜¯ä¸€ä¸ªå¼ é‡æˆ–å›¾åƒåˆ—è¡¨ï¼Œè¿”å›çš„æ˜¯ç»è¿‡é¢„å¤„ç†çš„å›¾åƒåˆ—è¡¨ï¼Œå‡†å¤‡å¥½è¿›è¡Œæ¨¡å‹æ¨ç†ã€‚

æ•´ä¸ªæ¨¡å—çš„è®¾è®¡ä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨RT-DETRæ¨¡å‹è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œåªéœ€æä¾›æ¨¡å‹æ–‡ä»¶å’Œè¾“å…¥æºå³å¯è¿›è¡Œé¢„æµ‹ã€‚ä»£ç ä¸­è¿˜æä¾›äº†ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®ä¾‹åŒ–`RTDETRPredictor`å¹¶è°ƒç”¨å…¶é¢„æµ‹åŠŸèƒ½ã€‚

#### 11.4 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\autobackend.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class AutoBackend(nn.Module):
    """
    å¤„ç†Ultralytics YOLOæ¨¡å‹çš„åŠ¨æ€åç«¯é€‰æ‹©ã€‚

    AutoBackendç±»æ—¨åœ¨ä¸ºå„ç§æ¨ç†å¼•æ“æä¾›æŠ½è±¡å±‚ã€‚å®ƒæ”¯æŒå¤šç§æ ¼å¼ï¼Œæ¯ç§æ ¼å¼éƒ½æœ‰ç‰¹å®šçš„å‘½åçº¦å®šã€‚
    """

    @torch.no_grad()
    def __init__(self,
                 weights='yolov8n.pt',
                 device=torch.device('cpu'),
                 dnn=False,
                 data=None,
                 fp16=False,
                 fuse=True,
                 verbose=True):
        """
        åˆå§‹åŒ–AutoBackendä»¥è¿›è¡Œæ¨ç†ã€‚

        å‚æ•°:
            weights (str): æ¨¡å‹æƒé‡æ–‡ä»¶çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º'yolov8n.pt'ã€‚
            device (torch.device): è¿è¡Œæ¨¡å‹çš„è®¾å¤‡ï¼Œé»˜è®¤ä¸ºCPUã€‚
            dnn (bool): æ˜¯å¦ä½¿ç”¨OpenCV DNNæ¨¡å—è¿›è¡ŒONNXæ¨ç†ï¼Œé»˜è®¤ä¸ºFalseã€‚
            data (str | Path | optional): åŒ…å«ç±»åçš„é¢å¤–data.yamlæ–‡ä»¶çš„è·¯å¾„ï¼Œé»˜è®¤ä¸ºNoneã€‚
            fp16 (bool): æ˜¯å¦å¯ç”¨åŠç²¾åº¦æ¨ç†ï¼Œä»…åœ¨ç‰¹å®šåç«¯æ”¯æŒï¼Œé»˜è®¤ä¸ºFalseã€‚
            fuse (bool): æ˜¯å¦èåˆConv2Då’ŒBatchNormå±‚ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œé»˜è®¤ä¸ºTrueã€‚
            verbose (bool): æ˜¯å¦å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼Œé»˜è®¤ä¸ºTrueã€‚
        """
        super().__init__()
        # å¤„ç†æƒé‡æ–‡ä»¶è·¯å¾„
        w = str(weights[0] if isinstance(weights, list) else weights)
        # æ£€æµ‹æ¨¡å‹ç±»å‹
        pt, jit, onnx, xml, engine, coreml, saved_model, pb, tflite, edgetpu, tfjs, paddle, ncnn, triton = \
            self._model_type(w)

        # è®¾ç½®è®¾å¤‡
        cuda = torch.cuda.is_available() and device.type != 'cpu'  # æ£€æŸ¥CUDAå¯ç”¨æ€§
        if cuda and not any([nn_module, pt, jit, engine]):  # å¦‚æœä¸æ”¯æŒGPUæ ¼å¼ï¼Œåˆ™ä½¿ç”¨CPU
            device = torch.device('cpu')
            cuda = False

        # ä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼ˆå¦‚æœä¸æ˜¯æœ¬åœ°æ–‡ä»¶ï¼‰
        if not (pt or triton or nn_module):
            w = attempt_download_asset(w)

        # åŠ è½½æ¨¡å‹
        if nn_module:  # å†…å­˜ä¸­çš„PyTorchæ¨¡å‹
            model = weights.to(device)
            model = model.fuse(verbose=verbose) if fuse else model
            self.model = model  # æ˜¾å¼åˆ†é…ç»™self.model
        elif pt:  # PyTorchæ¨¡å‹
            from ultralytics.nn.tasks import attempt_load_weights
            model = attempt_load_weights(weights if isinstance(weights, list) else w,
                                         device=device,
                                         inplace=True,
                                         fuse=fuse)
            self.model = model  # æ˜¾å¼åˆ†é…ç»™self.model
        elif jit:  # TorchScriptæ¨¡å‹
            model = torch.jit.load(w, map_location=device)
            self.model = model  # æ˜¾å¼åˆ†é…ç»™self.model
        elif onnx:  # ONNX Runtime
            import onnxruntime
            self.session = onnxruntime.InferenceSession(w)  # åˆ›å»ºONNXæ¨ç†ä¼šè¯
        # å…¶ä»–æ¨¡å‹æ ¼å¼çš„åŠ è½½çœç•¥...

        # æ£€æŸ¥ç±»å
        if 'names' not in locals():  # å¦‚æœç±»åç¼ºå¤±
            names = self._apply_default_class_names(data)
        names = check_class_names(names)  # éªŒè¯ç±»å

        # ç¦ç”¨æ¢¯åº¦è®¡ç®—
        if pt:
            for p in model.parameters():
                p.requires_grad = False

        self.__dict__.update(locals())  # å°†æ‰€æœ‰å±€éƒ¨å˜é‡åˆ†é…ç»™self

    def forward(self, im, augment=False, visualize=False):
        """
        åœ¨YOLOv8 MultiBackendæ¨¡å‹ä¸Šè¿è¡Œæ¨ç†ã€‚

        å‚æ•°:
            im (torch.Tensor): è¦è¿›è¡Œæ¨ç†çš„å›¾åƒå¼ é‡ã€‚
            augment (bool): æ˜¯å¦åœ¨æ¨ç†è¿‡ç¨‹ä¸­æ‰§è¡Œæ•°æ®å¢å¼ºï¼Œé»˜è®¤ä¸ºFalseã€‚
            visualize (bool): æ˜¯å¦å¯è§†åŒ–è¾“å‡ºé¢„æµ‹ï¼Œé»˜è®¤ä¸ºFalseã€‚

        è¿”å›:
            (tuple): åŒ…å«åŸå§‹è¾“å‡ºå¼ é‡å’Œå¤„ç†åçš„è¾“å‡ºï¼ˆå¦‚æœvisualize=Trueï¼‰ã€‚
        """
        b, ch, h, w = im.shape  # è·å–è¾“å…¥å›¾åƒçš„å½¢çŠ¶
        if self.fp16 and im.dtype != torch.float16:
            im = im.half()  # è½¬æ¢ä¸ºFP16æ ¼å¼

        # æ ¹æ®æ¨¡å‹ç±»å‹æ‰§è¡Œæ¨ç†
        if self.pt or self.nn_module:  # PyTorchæ¨¡å‹
            y = self.model(im, augment=augment, visualize=visualize)
        elif self.onnx:  # ONNX Runtime
            im = im.cpu().numpy()  # è½¬æ¢ä¸ºnumpyæ•°ç»„
            y = self.session.run(self.output_names, {self.session.get_inputs()[0].name: im})
        # å…¶ä»–æ¨¡å‹æ ¼å¼çš„æ¨ç†çœç•¥...

        return self.from_numpy(y)  # å°†è¾“å‡ºè½¬æ¢ä¸ºå¼ é‡å¹¶è¿”å›

    def from_numpy(self, x):
        """
        å°†numpyæ•°ç»„è½¬æ¢ä¸ºå¼ é‡ã€‚

        å‚æ•°:
            x (np.ndarray): è¦è½¬æ¢çš„æ•°ç»„ã€‚

        è¿”å›:
            (torch.Tensor): è½¬æ¢åçš„å¼ é‡ã€‚
        """
        return torch.tensor(x).to(self.device) if isinstance(x, np.ndarray) else x

    @staticmethod
    def _model_type(p='path/to/model.pt'):
        """
        æ ¹æ®æ¨¡å‹æ–‡ä»¶è·¯å¾„è¿”å›æ¨¡å‹ç±»å‹ã€‚

        å‚æ•°:
            p: æ¨¡å‹æ–‡ä»¶çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º'path/to/model.pt'ã€‚
        """
        from ultralytics.engine.exporter import export_formats
        sf = list(export_formats().Suffix)  # è·å–æ”¯æŒçš„æ–‡ä»¶åç¼€
        name = Path(p).name
        types = [s in name for s in sf]  # æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«æ”¯æŒçš„åç¼€
        return types  # è¿”å›æ¨¡å‹ç±»å‹
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **AutoBackendç±»**ï¼šè´Ÿè´£å¤„ç†ä¸åŒæ ¼å¼çš„YOLOæ¨¡å‹çš„åŠ è½½å’Œæ¨ç†ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®æ¨¡å‹çš„æƒé‡ã€è®¾å¤‡ã€ç²¾åº¦ç­‰å‚æ•°ï¼Œå¹¶æ ¹æ®æƒé‡æ–‡ä»¶çš„ç±»å‹åŠ è½½ç›¸åº”çš„æ¨¡å‹ã€‚
3. **forwardæ–¹æ³•**ï¼šå®ç°æ¨¡å‹çš„æ¨ç†é€»è¾‘ï¼Œæ ¹æ®è¾“å…¥çš„å›¾åƒå¼ é‡æ‰§è¡Œæ¨ç†ï¼Œå¹¶è¿”å›ç»“æœã€‚
4. **from_numpyæ–¹æ³•**ï¼šå°†numpyæ•°ç»„è½¬æ¢ä¸ºPyTorchå¼ é‡ï¼Œæ–¹ä¾¿åç»­å¤„ç†ã€‚
5. **_model_typeé™æ€æ–¹æ³•**ï¼šæ ¹æ®ç»™å®šçš„æ¨¡å‹æ–‡ä»¶è·¯å¾„è¿”å›æ¨¡å‹çš„ç±»å‹ï¼Œä¾¿äºåç»­å¤„ç†ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯Ultralytics YOLOï¼ˆYou Only Look Onceï¼‰æ¨¡å‹çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸»è¦è´Ÿè´£åŠ¨æ€é€‰æ‹©åç«¯ä»¥è¿è¡Œæ¨ç†ã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ”¯æŒå¤šç§æ¨¡å‹æ ¼å¼ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åœ¨ä¸åŒçš„æ¨ç†å¼•æ“ä¸Šä½¿ç”¨YOLOæ¨¡å‹ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶ä¸­å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬Pythonæ ‡å‡†åº“ä¸­çš„æ¨¡å—å’Œç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`torch`ã€`cv2`ã€`numpy`ç­‰ã€‚è¿™äº›åº“æä¾›äº†æ·±åº¦å­¦ä¹ ã€å›¾åƒå¤„ç†å’Œæ•°å€¼è®¡ç®—ç­‰åŠŸèƒ½ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º`check_class_names`çš„å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥å’Œå¤„ç†ç±»åˆ«åç§°ã€‚è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿå°†ç±»åˆ«åç§°ä»åˆ—è¡¨è½¬æ¢ä¸ºå­—å…¸ï¼Œå¹¶ç¡®ä¿ç±»åˆ«ç´¢å¼•çš„æœ‰æ•ˆæ€§ï¼Œç¡®ä¿å®ƒä»¬åœ¨æ­£ç¡®çš„èŒƒå›´å†…ã€‚

`AutoBackend`ç±»æ˜¯æ–‡ä»¶çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå®ƒç»§æ‰¿è‡ª`torch.nn.Module`ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°æ¥å—å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬æ¨¡å‹æƒé‡è·¯å¾„ã€è®¾å¤‡ç±»å‹ã€æ˜¯å¦ä½¿ç”¨DNNæ¨¡å—ã€æ•°æ®æ–‡ä»¶è·¯å¾„ç­‰ã€‚æ ¹æ®è¾“å…¥çš„æ¨¡å‹æ ¼å¼ï¼Œæ„é€ å‡½æ•°ä¼šåŠ¨æ€åŠ è½½ç›¸åº”çš„æ¨¡å‹å¹¶è¿›è¡Œåˆå§‹åŒ–ã€‚

åœ¨æ¨¡å‹åŠ è½½è¿‡ç¨‹ä¸­ï¼Œ`AutoBackend`æ”¯æŒå¤šç§æ ¼å¼ï¼ŒåŒ…æ‹¬PyTorchã€TorchScriptã€ONNXã€OpenVINOã€TensorRTç­‰ã€‚æ¯ç§æ ¼å¼éƒ½æœ‰å…¶ç‰¹å®šçš„åŠ è½½æ–¹å¼å’Œè¦æ±‚ï¼Œä»£ç ä¸­é€šè¿‡æ¡ä»¶åˆ¤æ–­æ¥å¤„ç†ä¸åŒçš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå¯¹äºPyTorchæ¨¡å‹ï¼Œä½¿ç”¨`attempt_load_weights`å‡½æ•°åŠ è½½æƒé‡ï¼›å¯¹äºONNXæ¨¡å‹ï¼Œä½¿ç”¨OpenCVçš„DNNæ¨¡å—è¿›è¡ŒåŠ è½½ï¼›å¯¹äºTensorRTæ¨¡å‹ï¼Œåˆ™ä½¿ç”¨TensorRTçš„APIè¿›è¡Œå¤„ç†ã€‚

åœ¨æ¨¡å‹åŠ è½½å®Œæˆåï¼Œæ„é€ å‡½æ•°è¿˜ä¼šå¤„ç†ä¸€äº›å…ƒæ•°æ®ï¼Œæ¯”å¦‚æ¨¡å‹çš„è¾“å…¥è¾“å‡ºåç§°ã€å›¾åƒå¤§å°å’Œç±»åˆ«åç§°ç­‰ã€‚è¿™äº›ä¿¡æ¯åœ¨åç»­çš„æ¨ç†è¿‡ç¨‹ä¸­æ˜¯å¿…éœ€çš„ã€‚

`forward`æ–¹æ³•æ˜¯è¯¥ç±»çš„å¦ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒè´Ÿè´£æ‰§è¡Œæ¨ç†æ“ä½œã€‚è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå›¾åƒå¼ é‡ä½œä¸ºè¾“å…¥ï¼Œå¹¶æ ¹æ®ä¸åŒçš„åç«¯æ‰§è¡Œç›¸åº”çš„æ¨ç†é€»è¾‘ã€‚æ— è®ºæ˜¯PyTorchã€ONNXè¿˜æ˜¯TensorRTï¼Œ`forward`æ–¹æ³•éƒ½èƒ½æ ¹æ®æ¨¡å‹ç±»å‹æ­£ç¡®å¤„ç†è¾“å…¥å¹¶è¿”å›è¾“å‡ºç»“æœã€‚

æ­¤å¤–ï¼Œ`warmup`æ–¹æ³•ç”¨äºé¢„çƒ­æ¨¡å‹ï¼Œé€šè¿‡è¿è¡Œä¸€æ¬¡å‰å‘ä¼ é€’æ¥æé«˜åç»­æ¨ç†çš„é€Ÿåº¦ã€‚`from_numpy`æ–¹æ³•åˆ™ç”¨äºå°†NumPyæ•°ç»„è½¬æ¢ä¸ºPyTorchå¼ é‡ï¼Œä»¥ä¾¿åœ¨æ¨ç†è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

æœ€åï¼Œæ–‡ä»¶ä¸­è¿˜åŒ…å«äº†ä¸€äº›é™æ€æ–¹æ³•ï¼Œç”¨äºå¤„ç†é»˜è®¤ç±»åˆ«åç§°å’Œåˆ¤æ–­æ¨¡å‹ç±»å‹ã€‚è¿™äº›æ–¹æ³•ä¸ºç”¨æˆ·æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œä½¿å¾—åœ¨ä½¿ç”¨YOLOæ¨¡å‹æ—¶èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è¿›è¡Œé…ç½®å’Œè°ƒæ•´ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†YOLOæ¨¡å‹çš„åŠ¨æ€åç«¯é€‰æ‹©å’Œæ¨ç†åŠŸèƒ½ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿåœ¨å¤šç§ç¯å¢ƒä¸­é«˜æ•ˆåœ°ä½¿ç”¨YOLOè¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦é›†ä¸­åœ¨YOLOæ¨¡å‹çš„è®­ç»ƒå’Œæ•°æ®å¤„ç†ä¸Šï¼š

```python
import random
import numpy as np
import torch.nn as nn
from ultralytics.data import build_dataloader, build_yolo_dataset
from ultralytics.engine.trainer import BaseTrainer
from ultralytics.models import yolo
from ultralytics.nn.tasks import DetectionModel
from ultralytics.utils import LOGGER, RANK
from ultralytics.utils.torch_utils import de_parallel, torch_distributed_zero_first

class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œ'train'æˆ–'val'ï¼Œç”¨äºè‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºæ–¹å¼ã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)  # è·å–æ¨¡å‹çš„æœ€å¤§æ­¥å¹…
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ä»…åˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†
            dataset = self.build_dataset(dataset_path, mode, batch_size)
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©æ–°çš„å›¾åƒå¤§å°
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœéœ€è¦ç¼©æ”¾
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºYOLOæ¨¡å‹è®­ç»ƒçš„ç±»ï¼Œç»§æ‰¿è‡ª`BaseTrainer`ï¼Œæä¾›äº†æ„å»ºæ•°æ®é›†ã€æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€æ¨¡å‹è·å–å’Œç»˜å›¾ç­‰åŠŸèƒ½ã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ ¹æ®ç»™å®šçš„å›¾åƒè·¯å¾„å’Œæ¨¡å¼æ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¯èƒ½çš„ç¼©æ”¾æ“ä½œã€‚
5. **get_modelæ–¹æ³•**ï¼šåˆ›å»ºå¹¶è¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **plot_training_samplesæ–¹æ³•**ï¼šç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®ç°ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚æ–‡ä»¶ä¸­ä¸»è¦åŒ…å«äº†æ•°æ®é›†æ„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡å‹é¢„å¤„ç†ã€æ¨¡å‹è®¾ç½®ã€æ¨¡å‹è·å–ã€éªŒè¯å™¨è·å–ã€æŸå¤±é¡¹æ ‡è®°ã€è®­ç»ƒè¿›åº¦å­—ç¬¦ä¸²ç”Ÿæˆã€è®­ç»ƒæ ·æœ¬ç»˜åˆ¶ã€æŒ‡æ ‡ç»˜åˆ¶ä»¥åŠè®­ç»ƒæ ‡ç­¾ç»˜åˆ¶ç­‰åŠŸèƒ½ã€‚

é¦–å…ˆï¼Œç¨‹åºé€šè¿‡å¯¼å…¥å¿…è¦çš„åº“å’Œæ¨¡å—ï¼Œè®¾ç½®äº†åŸºç¡€çš„è®­ç»ƒç¯å¢ƒã€‚`DetectionTrainer` ç±»æ˜¯æ ¸å¿ƒéƒ¨åˆ†ï¼Œæä¾›äº†è®­ç»ƒæ‰€éœ€çš„å„ç§æ–¹æ³•ã€‚`build_dataset` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†ï¼Œæ¥å—å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ã€‚å®ƒé€šè¿‡è°ƒç”¨ `build_yolo_dataset` å‡½æ•°æ¥ç”Ÿæˆæ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„æ­¥å¹…è®¾ç½®åˆé€‚çš„å›¾åƒå°ºå¯¸ã€‚

`get_dataloader` æ–¹æ³•ç”¨äºæ„å»ºå’Œè¿”å›æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚è¯¥æ–¹æ³•ä¼šæ ¹æ®æ¨¡å¼é€‰æ‹©æ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶è®¾ç½®å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚

åœ¨ `preprocess_batch` æ–¹æ³•ä¸­ï¼Œç¨‹åºå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚è‹¥å¯ç”¨å¤šå°ºåº¦è®­ç»ƒï¼Œè¿˜ä¼šéšæœºè°ƒæ•´å›¾åƒçš„å°ºå¯¸ã€‚

`set_model_attributes` æ–¹æ³•åˆ™è´Ÿè´£è®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ï¼Œä»¥ç¡®ä¿æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«è®­ç»ƒæ•°æ®ä¸­çš„ç›®æ ‡ã€‚

`get_model` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯æ¨¡å‹æ€§èƒ½çš„éªŒè¯å™¨ï¼Œè®°å½•æŸå¤±åç§°ä»¥ä¾¿åç»­åˆ†æã€‚

`label_loss_items` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªåŒ…å«è®­ç»ƒæŸå¤±é¡¹çš„å­—å…¸ï¼Œæ–¹ä¾¿åç»­çš„ç›‘æ§å’Œè°ƒè¯•ã€‚`progress_string` æ–¹æ³•åˆ™è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå°ºå¯¸ç­‰ä¿¡æ¯ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œ`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒæ•ˆæœã€‚`plot_metrics` æ–¹æ³•åˆ™ä» CSV æ–‡ä»¶ä¸­ç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†ææ¨¡å‹æ€§èƒ½ã€‚æœ€åï¼Œ`plot_training_labels` æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œå±•ç¤ºæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„è¡¨ç°ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºè®­ç»ƒ YOLO æ¨¡å‹ï¼Œæ¶µç›–äº†æ•°æ®å¤„ç†ã€æ¨¡å‹è®¾ç½®ã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œé€‚åˆäºç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„å®ç°å’Œç ”ç©¶ã€‚

#### 11.6 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\sam\modules\tiny_encoder.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦ä¿ç•™äº† TinyViT æ¨¡å‹çš„ç»“æ„å’Œå…³é”®ç»„ä»¶ã€‚

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class Conv2d_BN(nn.Sequential):
    """æ‰§è¡Œ2Då·ç§¯å¹¶éšåè¿›è¡Œæ‰¹é‡å½’ä¸€åŒ–çš„é¡ºåºå®¹å™¨ã€‚"""

    def __init__(self, in_channels, out_channels, kernel_size=1, stride=1, padding=0):
        """åˆå§‹åŒ–å·ç§¯å±‚å’Œæ‰¹é‡å½’ä¸€åŒ–å±‚ã€‚"""
        super().__init__()
        self.add_module('conv', nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding, bias=False))
        self.add_module('bn', nn.BatchNorm2d(out_channels))

class PatchEmbed(nn.Module):
    """å°†å›¾åƒåµŒå…¥ä¸ºè¡¥ä¸å¹¶æŠ•å½±åˆ°æŒ‡å®šçš„åµŒå…¥ç»´åº¦ã€‚"""

    def __init__(self, in_chans, embed_dim, resolution):
        """åˆå§‹åŒ–è¡¥ä¸åµŒå…¥å±‚ã€‚"""
        super().__init__()
        self.patches_resolution = (resolution // 4, resolution // 4)  # æ¯ä¸ªè¡¥ä¸çš„åˆ†è¾¨ç‡
        self.seq = nn.Sequential(
            Conv2d_BN(in_chans, embed_dim // 2, kernel_size=3, stride=2, padding=1),
            nn.GELU(),  # æ¿€æ´»å‡½æ•°
            Conv2d_BN(embed_dim // 2, embed_dim, kernel_size=3, stride=2, padding=1),
        )

    def forward(self, x):
        """å°†è¾“å…¥å¼ é‡é€šè¿‡è¡¥ä¸åµŒå…¥å±‚çš„åºåˆ—æ“ä½œã€‚"""
        return self.seq(x)

class MBConv(nn.Module):
    """ç§»åŠ¨åå‘ç“¶é¢ˆå·ç§¯å±‚ï¼ŒEfficientNetæ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚"""

    def __init__(self, in_chans, out_chans, expand_ratio):
        """åˆå§‹åŒ–MBConvå±‚ã€‚"""
        super().__init__()
        self.conv1 = Conv2d_BN(in_chans, in_chans * expand_ratio, kernel_size=1)
        self.conv2 = Conv2d_BN(in_chans * expand_ratio, in_chans * expand_ratio, kernel_size=3, padding=1, groups=in_chans * expand_ratio)
        self.conv3 = Conv2d_BN(in_chans * expand_ratio, out_chans, kernel_size=1, bn_weight_init=0.0)

    def forward(self, x):
        """å®ç°MBConvå±‚çš„å‰å‘ä¼ æ’­ã€‚"""
        return self.conv3(self.conv2(self.conv1(x)))

class TinyViTBlock(nn.Module):
    """TinyViTå—ï¼Œåº”ç”¨è‡ªæ³¨æ„åŠ›å’Œå±€éƒ¨å·ç§¯ã€‚"""

    def __init__(self, dim, num_heads):
        """åˆå§‹åŒ–TinyViTå—ã€‚"""
        super().__init__()
        self.attn = nn.MultiheadAttention(dim, num_heads)  # å¤šå¤´è‡ªæ³¨æ„åŠ›
        self.local_conv = Conv2d_BN(dim, dim, kernel_size=3, padding=1)  # å±€éƒ¨å·ç§¯

    def forward(self, x):
        """åº”ç”¨è‡ªæ³¨æ„åŠ›å’Œå±€éƒ¨å·ç§¯ã€‚"""
        x = self.attn(x, x, x)[0]  # è‡ªæ³¨æ„åŠ›
        x = self.local_conv(x)  # å±€éƒ¨å·ç§¯
        return x

class TinyViT(nn.Module):
    """TinyViTæ¶æ„ï¼Œç”¨äºè§†è§‰ä»»åŠ¡ã€‚"""

    def __init__(self, img_size=224, in_chans=3, num_classes=1000):
        """åˆå§‹åŒ–TinyViTæ¨¡å‹ã€‚"""
        super().__init__()
        self.patch_embed = PatchEmbed(in_chans, embed_dim=96, resolution=img_size)  # è¡¥ä¸åµŒå…¥å±‚
        self.layers = nn.ModuleList([TinyViTBlock(dim=96, num_heads=3) for _ in range(4)])  # å¤šä¸ªTinyViTå—
        self.head = nn.Linear(96, num_classes)  # åˆ†ç±»å¤´

    def forward(self, x):
        """æ‰§è¡Œå‰å‘ä¼ æ’­ã€‚"""
        x = self.patch_embed(x)  # åµŒå…¥è¡¥ä¸
        for layer in self.layers:
            x = layer(x)  # é€šè¿‡æ¯ä¸ªTinyViTå—
        return self.head(x)  # åˆ†ç±»è¾“å‡º
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **Conv2d_BN**: è¿™ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªç»„åˆçš„å·ç§¯å±‚å’Œæ‰¹é‡å½’ä¸€åŒ–å±‚ï¼Œæ–¹ä¾¿åœ¨æ¨¡å‹ä¸­ä½¿ç”¨ã€‚
2. **PatchEmbed**: è¯¥ç±»å°†è¾“å…¥å›¾åƒåˆ†å‰²æˆè¡¥ä¸ï¼Œå¹¶é€šè¿‡å·ç§¯å±‚å°†å…¶åµŒå…¥åˆ°æŒ‡å®šçš„ç»´åº¦ã€‚
3. **MBConv**: è¿™æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å·ç§¯å±‚ï¼Œé‡‡ç”¨ç§»åŠ¨åå‘ç“¶é¢ˆç»“æ„ï¼Œé€‚ç”¨äºè½»é‡çº§æ¨¡å‹ã€‚
4. **TinyViTBlock**: è¿™ä¸ªç±»å®ç°äº†TinyViTçš„åŸºæœ¬æ„å»ºå—ï¼Œç»“åˆäº†è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå±€éƒ¨å·ç§¯ã€‚
5. **TinyViT**: è¿™æ˜¯æ•´ä¸ªæ¨¡å‹çš„ä¸»ç±»ï¼Œè´Ÿè´£å°†è¾“å…¥å›¾åƒé€šè¿‡è¡¥ä¸åµŒå…¥ã€å¤šä¸ªTinyViTå—å¤„ç†ï¼Œæœ€åè¾“å‡ºåˆ†ç±»ç»“æœã€‚

è¯¥ä»£ç å®ç°äº†TinyViTæ¨¡å‹çš„åŸºæœ¬ç»“æ„ï¼ŒåŒ…å«äº†å›¾åƒå¤„ç†ã€ç‰¹å¾æå–å’Œåˆ†ç±»çš„ä¸»è¦æ­¥éª¤ã€‚

è¯¥ç¨‹åºæ–‡ä»¶æ˜¯å®ç°äº†TinyViTæ¨¡å‹çš„ä»£ç ï¼ŒTinyViTæ˜¯ä¸€ç§ç”¨äºè§†è§‰ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œçµæ„Ÿæ¥æºäºLeViTå’ŒSwin Transformerã€‚ä»£ç ä¸­å®šä¹‰äº†å¤šä¸ªç±»ï¼Œæ¯ä¸ªç±»å®ç°äº†TinyViTæ¨¡å‹çš„ä¸åŒç»„ä»¶ã€‚

é¦–å…ˆï¼Œ`Conv2d_BN`ç±»æ˜¯ä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œæ‰§è¡Œ2Då·ç§¯æ“ä½œå¹¶éšåè¿›è¡Œæ‰¹å½’ä¸€åŒ–ã€‚å®ƒçš„æ„é€ å‡½æ•°æ¥å—å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºé€šé“æ•°ã€å·ç§¯æ ¸å¤§å°ã€æ­¥å¹…ã€å¡«å……ç­‰ï¼Œåˆå§‹åŒ–æ—¶ä¼šåˆ›å»ºå·ç§¯å±‚å’Œæ‰¹å½’ä¸€åŒ–å±‚ã€‚

æ¥ä¸‹æ¥ï¼Œ`PatchEmbed`ç±»è´Ÿè´£å°†è¾“å…¥å›¾åƒåµŒå…¥ä¸ºå¤šä¸ªå°å—ï¼Œå¹¶å°†å…¶æŠ•å½±åˆ°æŒ‡å®šçš„åµŒå…¥ç»´åº¦ã€‚å®ƒé€šè¿‡ä¸€ç³»åˆ—å·ç§¯å’Œæ¿€æ´»å‡½æ•°å°†è¾“å…¥å›¾åƒè½¬åŒ–ä¸ºå°å—çš„ç‰¹å¾è¡¨ç¤ºã€‚

`MBConv`ç±»å®ç°äº†Mobile Inverted Bottleneckå·ç§¯å±‚ï¼Œè¿™æ˜¯EfficientNetæ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç±»é€šè¿‡å¤šä¸ªå·ç§¯å±‚å’Œæ¿€æ´»å‡½æ•°æ„å»ºäº†ä¸€ä¸ªé«˜æ•ˆçš„å·ç§¯æ¨¡å—ï¼Œå¹¶æ”¯æŒè·³è·ƒè¿æ¥ã€‚

`PatchMerging`ç±»åˆ™è´Ÿè´£å°†ç‰¹å¾å›¾ä¸­çš„ç›¸é‚»å°å—åˆå¹¶ï¼Œå¹¶æŠ•å½±åˆ°æ–°çš„ç»´åº¦ã€‚å®ƒçš„å‰å‘ä¼ æ’­æ–¹æ³•ä¼šå¯¹è¾“å…¥è¿›è¡Œå·ç§¯å’Œæ¿€æ´»æ“ä½œï¼Œå¹¶è¿”å›å¤„ç†åçš„ç»“æœã€‚

`ConvLayer`ç±»ç”±å¤šä¸ªMBConvå±‚ç»„æˆï¼Œæä¾›äº†å¯¹è¾“å…¥è¿›è¡Œå¤šæ¬¡å·ç§¯æ“ä½œçš„èƒ½åŠ›ï¼Œå¹¶æ”¯æŒä¸‹é‡‡æ ·å’Œæ¢¯åº¦æ£€æŸ¥ç‚¹åŠŸèƒ½ï¼Œä»¥èŠ‚çœå†…å­˜ã€‚

`Mlp`ç±»å®ç°äº†å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼Œç”¨äºTransformeræ¶æ„ä¸­çš„å‰é¦ˆç½‘ç»œã€‚å®ƒåŒ…å«å±‚å½’ä¸€åŒ–å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚ã€‚

`Attention`ç±»å®ç°äº†å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ”¯æŒç©ºé—´æ„ŸçŸ¥ï¼Œé€šè¿‡è®¡ç®—æŸ¥è¯¢ã€é”®å’Œå€¼çš„å…³ç³»æ¥è¿›è¡Œç‰¹å¾æå–ã€‚å®ƒè¿˜å¼•å…¥äº†å¯è®­ç»ƒçš„æ³¨æ„åŠ›åç½®ï¼Œä»¥å¢å¼ºæ¨¡å‹çš„è¡¨ç°ã€‚

`TinyViTBlock`ç±»æ˜¯TinyViTçš„åŸºæœ¬æ„å»ºå—ï¼Œç»“åˆäº†è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå±€éƒ¨å·ç§¯ã€‚å®ƒåœ¨å‰å‘ä¼ æ’­ä¸­é¦–å…ˆåº”ç”¨æ³¨æ„åŠ›æœºåˆ¶ï¼Œç„¶åé€šè¿‡å±€éƒ¨å·ç§¯å¤„ç†è¾“å…¥ã€‚

`BasicLayer`ç±»åˆ™æ˜¯TinyViTæ¶æ„ä¸­çš„ä¸€ä¸ªåŸºæœ¬å±‚ï¼ŒåŒ…å«å¤šä¸ªTinyViTå—ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°è¿›è¡Œä¸‹é‡‡æ ·ã€‚

`LayerNorm2d`ç±»å®ç°äº†2Dçš„å±‚å½’ä¸€åŒ–ï¼Œé€‚ç”¨äºå›¾åƒæ•°æ®çš„å½’ä¸€åŒ–å¤„ç†ã€‚

æœ€åï¼Œ`TinyViT`ç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„ä¸»ç±»ï¼Œè´Ÿè´£æ„å»ºTinyViTæ¶æ„ã€‚å®ƒæ¥å—å¤šä¸ªå‚æ•°ä»¥é…ç½®æ¨¡å‹çš„å„ä¸ªå±‚ï¼ŒåŒ…æ‹¬è¾“å…¥å›¾åƒå¤§å°ã€è¾“å…¥é€šé“æ•°ã€ç±»åˆ«æ•°ã€åµŒå…¥ç»´åº¦ã€å±‚æ·±åº¦ã€æ³¨æ„åŠ›å¤´æ•°ç­‰ã€‚è¯¥ç±»è¿˜å®ç°äº†æƒé‡åˆå§‹åŒ–ã€å­¦ä¹ ç‡è¡°å‡è®¾ç½®å’Œå‰å‘ä¼ æ’­æ–¹æ³•ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¯¥æ–‡ä»¶å®ç°äº†TinyViTæ¨¡å‹çš„å®Œæ•´ç»“æ„ï¼Œç»“åˆäº†å·ç§¯ã€æ³¨æ„åŠ›æœºåˆ¶å’Œå¤šå±‚æ„ŸçŸ¥æœºï¼Œæ—¨åœ¨æé«˜è§†è§‰ä»»åŠ¡çš„æ€§èƒ½ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ¶æ„æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOï¼ˆYou Only Look Onceï¼‰æ¨¡å‹çš„ç›®æ ‡æ£€æµ‹æ¡†æ¶ï¼Œæ—¨åœ¨æä¾›é«˜æ•ˆçš„è®­ç»ƒã€æ¨ç†å’Œæ¨¡å‹ç®¡ç†åŠŸèƒ½ã€‚é¡¹ç›®çš„æ¶æ„åŒ…æ‹¬å¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ï¼Œå¦‚å›è°ƒç®¡ç†ã€æ¨¡å‹é¢„æµ‹ã€æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ„å»ºç­‰ã€‚æ•´ä½“æ¶æ„è®¾è®¡çµæ´»ï¼Œæ”¯æŒå¤šç§æ¨¡å‹æ ¼å¼å’Œåç«¯ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿæ ¹æ®éœ€æ±‚è¿›è¡Œå®šåˆ¶å’Œæ‰©å±•ã€‚

ä¸»è¦åŠŸèƒ½æ¨¡å—åŒ…æ‹¬ï¼š
- **å›è°ƒç®¡ç†**ï¼šç”¨äºåœ¨è®­ç»ƒå’ŒéªŒè¯è¿‡ç¨‹ä¸­æ‰§è¡Œç‰¹å®šæ“ä½œï¼Œå¦‚è®°å½•æ—¥å¿—å’Œè°ƒæ•´å­¦ä¹ ç‡ã€‚
- **æ¨¡å‹é¢„æµ‹**ï¼šå®ç°ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„æ¨ç†åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§æ¨¡å‹æ ¼å¼ã€‚
- **æ•°æ®å¤„ç†**ï¼šè´Ÿè´£æ•°æ®é›†çš„æ„å»ºå’ŒåŠ è½½ï¼Œç¡®ä¿è®­ç»ƒå’ŒéªŒè¯è¿‡ç¨‹ä¸­çš„æ•°æ®å‡†å¤‡ã€‚
- **æ¨¡å‹è®­ç»ƒ**ï¼šæä¾›è®­ç»ƒæ¡†æ¶ï¼Œæ”¯æŒå¤šç§è®­ç»ƒé…ç½®å’Œç›‘æ§åŠŸèƒ½ã€‚
- **æ¨¡å‹æ„å»º**ï¼šå®ç°ä¸åŒçš„ç½‘ç»œæ¶æ„å’Œæ¨¡å—ï¼Œæ”¯æŒçµæ´»çš„æ¨¡å‹è®¾è®¡ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                     | åŠŸèƒ½æè¿°                                                                                     |
|----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| `code\ultralytics\utils\callbacks\base.py`                                                  | å®šä¹‰è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­çš„å›è°ƒå‡½æ•°ï¼Œæä¾›çµæ´»çš„å›è°ƒæœºåˆ¶ã€‚                                      |
| `ui.py`                                                                                     | å¯åŠ¨Streamlit Webåº”ç”¨ï¼Œç®€åŒ–é€šè¿‡å‘½ä»¤è¡Œè¿è¡ŒYOLOæ¨¡å‹çš„è¿‡ç¨‹ã€‚                                      |
| `code\ultralytics\models\rtdetr\predict.py`                                                | å®ç°RT-DETRæ¨¡å‹çš„é¢„æµ‹åŠŸèƒ½ï¼ŒåŒ…æ‹¬è¾“å…¥é¢„å¤„ç†å’Œè¾“å‡ºåå¤„ç†ã€‚                                          |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\autobackend.py`      | åŠ¨æ€é€‰æ‹©åç«¯ä»¥è¿è¡ŒYOLOæ¨¡å‹ï¼Œæ”¯æŒå¤šç§æ¨¡å‹æ ¼å¼çš„åŠ è½½å’Œæ¨ç†ã€‚                                        |
| `train.py`                                                                                  | æä¾›YOLOæ¨¡å‹çš„è®­ç»ƒæ¡†æ¶ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®¾ç½®ã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚                       |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\sam\modules\tiny_encoder.py` | å®ç°TinyViTæ¨¡å‹çš„å„ä¸ªç»„ä»¶ï¼ŒåŒ…æ‹¬å·ç§¯å±‚ã€æ³¨æ„åŠ›æœºåˆ¶å’Œå¤šå±‚æ„ŸçŸ¥æœºç­‰ï¼Œæ„å»ºè§†è§‰ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¶æ„ã€‚          |
| `code\ultralytics\nn\modules\__init__.py`                                                  | åˆå§‹åŒ–ç¥ç»ç½‘ç»œæ¨¡å—ï¼Œæä¾›å¯¹å…¶ä»–æ¨¡å—çš„è®¿é—®ã€‚                                                      |
| `code\ultralytics\engine\predictor.py`                                                     | å®ç°æ¨¡å‹çš„æ¨ç†é€»è¾‘ï¼Œå¤„ç†è¾“å…¥æ•°æ®å¹¶è¿”å›é¢„æµ‹ç»“æœã€‚                                                |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\backbone\lsknet.py`   | å®ç°LSKNetæ¨¡å‹çš„ç»“æ„ï¼Œä½œä¸ºYOLOæ¨¡å‹çš„éª¨å¹²ç½‘ç»œã€‚                                                 |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\yolo\classify\__init__.py` | åˆå§‹åŒ–YOLOåˆ†ç±»æ¨¡å—ï¼Œæä¾›åˆ†ç±»åŠŸèƒ½çš„ç›¸å…³å®ç°ã€‚                                                   |
| `code\ultralytics\utils\benchmarks.py`                                                     | æä¾›æ€§èƒ½åŸºå‡†æµ‹è¯•åŠŸèƒ½ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹çš„è¿è¡Œæ•ˆç‡å’Œé€Ÿåº¦ã€‚                                            |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\data\utils.py`         | å®ç°æ•°æ®å¤„ç†å’Œè½¬æ¢çš„å·¥å…·å‡½æ•°ï¼Œæ”¯æŒæ•°æ®é›†çš„åŠ è½½å’Œé¢„å¤„ç†ã€‚                                        |
| `code\ultralytics\models\yolo\segment\train.py`                                            | æä¾›YOLOæ¨¡å‹çš„åˆ†å‰²ä»»åŠ¡è®­ç»ƒæ¡†æ¶ï¼Œæ”¯æŒåˆ†å‰²æ•°æ®é›†çš„æ„å»ºå’Œè®­ç»ƒè¿‡ç¨‹ã€‚                                   |

ä»¥ä¸Šè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†é¡¹ç›®çš„æ¨¡å—åŒ–è®¾è®¡å’Œå„ä¸ªç»„ä»¶ä¹‹é—´çš„åä½œå…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/Zpuampps](https://mbd.pub/o/bread/Zpuampps)